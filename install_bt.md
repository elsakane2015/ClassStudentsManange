# æ™ºæ…§æ ¡å›­è€ƒå‹¤ç³»ç»Ÿ - å®å¡”é¢æ¿å®‰è£…æ•™ç¨‹

æœ¬æ•™ç¨‹é€‚ç”¨äºåœ¨ **å®å¡”é¢æ¿ (BT Panel)** ç¯å¢ƒä¸‹éƒ¨ç½²æ™ºæ…§æ ¡å›­è€ƒå‹¤ç³»ç»Ÿã€‚

---

## âš¡ å¿«é€Ÿå®‰è£…ï¼ˆæ¨èï¼‰

ä½¿ç”¨é¢„ç¼–è¯‘å‘å¸ƒåŒ…ï¼Œ**æ— éœ€å‘½ä»¤è¡Œæ“ä½œ**ï¼Œåƒ WordPress ä¸€æ ·ç®€å•ï¼

### ç¬¬ä¸€æ­¥ï¼šä¸‹è½½å‘å¸ƒåŒ…

ä» GitHub Releases ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ `smartcampus-xxx.zip`

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºç«™ç‚¹å’Œæ•°æ®åº“

1. ç™»å½•å®å¡”é¢æ¿
2. ç‚¹å‡» **ç½‘ç«™** â†’ **æ·»åŠ ç«™ç‚¹**
3. å¡«å†™ä¿¡æ¯ï¼š
   - **åŸŸå**ï¼šä½ çš„åŸŸåï¼ˆå¦‚ `attendance.example.com`ï¼‰
   - **æ•°æ®åº“**ï¼šé€‰æ‹© **MySQL**ï¼Œå­—ç¬¦é›†é€‰æ‹© **utf8mb4**
   - **PHPç‰ˆæœ¬**ï¼šé€‰æ‹© **PHP 8.2** æˆ–æ›´é«˜
4. è®°å½•æ•°æ®åº“ä¿¡æ¯ï¼ˆæ•°æ®åº“åã€ç”¨æˆ·åã€å¯†ç ï¼‰

### ç¬¬ä¸‰æ­¥ï¼šä¸Šä¼ å¹¶è§£å‹

1. åœ¨å®å¡” **æ–‡ä»¶** ç®¡ç†ä¸­è¿›å…¥ç«™ç‚¹ç›®å½•
2. ä¸Šä¼  `smartcampus-xxx.zip`
3. è§£å‹ï¼Œå°†æ‰€æœ‰æ–‡ä»¶ç§»åŠ¨åˆ°ç«™ç‚¹æ ¹ç›®å½•
4. è®¾ç½®æƒé™ï¼š
   ```bash
   chmod -R 755 storage bootstrap/cache
   ```
5. **ç½‘ç«™ç›®å½•** â†’ å°† **è¿è¡Œç›®å½•** è®¾ç½®ä¸º `/public`
6. **ä¼ªé™æ€** â†’ é€‰æ‹© **laravel** æ¨¡æ¿

### ç¬¬å››æ­¥ï¼šè®¿é—®ç½‘ç«™å®Œæˆå®‰è£…

1. è®¿é—® `https://ä½ çš„åŸŸå`
2. è‡ªåŠ¨è¿›å…¥å®‰è£…å‘å¯¼
3. æŒ‰æ­¥éª¤å¡«å†™ï¼š
   - æ•°æ®åº“ä¿¡æ¯
   - å­¦æ ¡åç§°
   - ç®¡ç†å‘˜è´¦æˆ·
4. ç‚¹å‡»"å¼€å§‹å®‰è£…"
5. å®Œæˆï¼ğŸ‰

---

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

| ç»„ä»¶ | ç‰ˆæœ¬è¦æ±‚ | å¤‡æ³¨ |
|------|---------|------|
| PHP | 8.2+ | éœ€å®‰è£…æ‰©å±•ï¼šfileinfo, bcmath, ctype, json, mbstring, openssl, pdo, tokenizer, xml |
| MySQL | 5.7+ / 8.0+ | æ¨è 8.0 |
| Nginx | 1.18+ | æˆ– Apache 2.4+ |

> ğŸ’¡ ä½¿ç”¨é¢„ç¼–è¯‘å‘å¸ƒåŒ…æ—¶ï¼Œ**ä¸éœ€è¦** å®‰è£… Composer æˆ– Node.jsï¼

---

## ï¿½ ä»æºç å®‰è£…ï¼ˆå¼€å‘è€…ï¼‰


### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºç«™ç‚¹å’Œæ•°æ®åº“

1. ç™»å½•å®å¡”é¢æ¿
2. ç‚¹å‡» **ç½‘ç«™** â†’ **æ·»åŠ ç«™ç‚¹**
3. å¡«å†™ä¿¡æ¯ï¼š
   - **åŸŸå**ï¼šä½ çš„åŸŸåï¼ˆå¦‚ `attendance.example.com`ï¼‰
   - **æ•°æ®åº“**ï¼šé€‰æ‹© **MySQL**ï¼Œå­—ç¬¦é›†é€‰æ‹© **utf8mb4**
   - **PHPç‰ˆæœ¬**ï¼šé€‰æ‹© **PHP 8.2** æˆ–æ›´é«˜
4. è®°å½•æ•°æ®åº“ä¿¡æ¯ï¼ˆæ•°æ®åº“åã€ç”¨æˆ·åã€å¯†ç ï¼‰

### ç¬¬äºŒæ­¥ï¼šä¸Šä¼ ä»£ç 

**æ–¹å¼ä¸€ï¼šGit å…‹éš†ï¼ˆæ¨èï¼‰**
```bash
cd /www/wwwroot/ä½ çš„ç«™ç‚¹ç›®å½•
rm -rf * .*  # æ¸…ç©ºç›®å½•
git clone https://github.com/ä½ çš„ä»“åº“åœ°å€.git .
```

**æ–¹å¼äºŒï¼šä¸Šä¼ å‹ç¼©åŒ…**
1. ä¸Šä¼ ä»£ç å‹ç¼©åŒ…åˆ°ç«™ç‚¹ç›®å½•
2. è§£å‹åï¼Œå°†æ–‡ä»¶ç§»åŠ¨åˆ°ç«™ç‚¹æ ¹ç›®å½•ï¼š
```bash
cd /www/wwwroot/ä½ çš„ç«™ç‚¹ç›®å½•
mv è§£å‹ç›®å½•å/* è§£å‹ç›®å½•å/.[!.]* ./
rm -rf è§£å‹ç›®å½•å å‹ç¼©åŒ….zip
```

### ç¬¬ä¸‰æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡

```bash
cd /www/wwwroot/ä½ çš„ç«™ç‚¹ç›®å½•
cp .env.example .env
nano .env   # æˆ–åœ¨å®å¡”æ–‡ä»¶ç®¡ç†ä¸­ç¼–è¾‘
```

**ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š**
```env
APP_NAME="æ™ºæ…§æ ¡å›­"
APP_ENV=production
APP_DEBUG=false
APP_URL=https://ä½ çš„åŸŸå

DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=ä½ çš„æ•°æ®åº“å
DB_USERNAME=ä½ çš„æ•°æ®åº“ç”¨æˆ·å
DB_PASSWORD=ä½ çš„æ•°æ®åº“å¯†ç 
```

### ç¬¬å››æ­¥ï¼šå®‰è£…ä¾èµ–

```bash
cd /www/wwwroot/ä½ çš„ç«™ç‚¹ç›®å½•

# å®‰è£… PHP ä¾èµ–
composer install --no-dev --optimize-autoloader

# ç”Ÿæˆåº”ç”¨å¯†é’¥
php artisan key:generate
```

### ç¬¬äº”æ­¥ï¼šå®‰è£… Node.js å¹¶ç¼–è¯‘å‰ç«¯

åœ¨å®å¡” **è½¯ä»¶å•†åº—** ä¸­å®‰è£… **Node.jsç‰ˆæœ¬ç®¡ç†å™¨**ï¼Œç„¶åå®‰è£… Node.js 18+ã€‚

```bash
# éªŒè¯å®‰è£…
node -v
npm -v

# å®‰è£…å‰ç«¯ä¾èµ–å¹¶ç¼–è¯‘
npm install
npm run build
```

### ç¬¬å…­æ­¥ï¼šå¯¼å…¥æ•°æ®åº“

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ phpMyAdmin å¯¼å…¥ SQLï¼ˆæ¨èï¼‰

1. æ‰“å¼€å®å¡” â†’ **æ•°æ®åº“** â†’ æ‰¾åˆ°ä½ çš„æ•°æ®åº“ â†’ **ç®¡ç†**ï¼ˆè¿›å…¥ phpMyAdminï¼‰
2. ç‚¹å‡» **å¯¼å…¥** æ ‡ç­¾
3. é€‰æ‹©æ–‡ä»¶ `database/schema.sql`ï¼Œå­—ç¬¦é›†é€‰æ‹© `utf-8`
4. ç‚¹å‡» **æ‰§è¡Œ**

#### æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œè¿ç§»

```bash
php artisan migrate --force
```

> å¦‚æœé‡åˆ°é‡å¤åˆ—é”™è¯¯ï¼Œåˆ é™¤ `database/migrations/` ä¸­é‡å¤çš„è¿ç§»æ–‡ä»¶åé‡è¯•ã€‚

### ç¬¬ä¸ƒæ­¥ï¼šåˆå§‹åŒ–ç³»ç»Ÿæ•°æ®

#### 7.1 åœ¨ phpMyAdmin ä¸­æ‰§è¡Œ SQL åˆ›å»ºåˆå§‹æ•°æ®

æ‰“å¼€æ•°æ®åº“ï¼Œç‚¹å‡» **SQL** æ ‡ç­¾ï¼Œæ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼š

```sql
-- 1. åˆ›å»ºå­¦æ ¡ï¼ˆå¿…é¡» ID=1ï¼‰
INSERT INTO schools (id, name, created_at, updated_at) 
VALUES (1, 'æ™ºæ…§æ ¡å›­', NOW(), NOW());

-- 2. åˆ›å»ºç®¡ç†å‘˜ï¼ˆé‚®ç®±: admin@demo.comï¼Œå¯†ç : passwordï¼‰
INSERT INTO users (uuid, name, email, password, role, created_at, updated_at) 
VALUES (
    UUID(), 
    'Admin', 
    'admin@demo.com', 
    '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 
    'system_admin', 
    NOW(), 
    NOW()
);
```

#### 7.2 è¿è¡Œ Seeders å¡«å……ç³»ç»Ÿæ•°æ®

```bash
php artisan db:seed --class=SystemSettingsSeeder --force
php artisan db:seed --class=PermissionSeeder --force
php artisan db:seed --class=LeaveTypeSeeder --force
```

### ç¬¬å…«æ­¥ï¼šåˆ›å»º Storage é“¾æ¥å¹¶è®¾ç½®æƒé™

```bash
# åˆ›å»º storage é“¾æ¥
php artisan storage:link

# æ¸…ç†ç¼“å­˜
php artisan optimize:clear

# è®¾ç½®ç›®å½•æƒé™
chown -R www:www /www/wwwroot/ä½ çš„ç«™ç‚¹ç›®å½•
chmod -R 755 /www/wwwroot/ä½ çš„ç«™ç‚¹ç›®å½•
chmod -R 775 storage bootstrap/cache
```

### ç¬¬ä¹æ­¥ï¼šé…ç½®ç½‘ç«™ç›®å½•

åœ¨å®å¡”é¢æ¿ä¸­ï¼š

1. ç‚¹å‡»ç«™ç‚¹ â†’ **è®¾ç½®** â†’ **ç½‘ç«™ç›®å½•**
2. å°† **è¿è¡Œç›®å½•** è®¾ç½®ä¸º `/public`
3. ä¿å­˜

### ç¬¬åæ­¥ï¼šé…ç½®ä¼ªé™æ€

åœ¨å®å¡”é¢æ¿ä¸­ï¼š

1. ç‚¹å‡»ç«™ç‚¹ â†’ **è®¾ç½®** â†’ **ä¼ªé™æ€**
2. é€‰æ‹© **laravel** æ¨¡æ¿ï¼Œæˆ–æ‰‹åŠ¨æ·»åŠ ï¼š

```nginx
location / {
    try_files $uri $uri/ /index.php?$query_string;
}
```

3. ä¿å­˜

### ç¬¬åä¸€æ­¥ï¼šé…ç½® HTTPSï¼ˆæ¨èï¼‰

1. ç‚¹å‡»ç«™ç‚¹ â†’ **è®¾ç½®** â†’ **SSL**
2. é€‰æ‹© **Let's Encrypt** å…è´¹è¯ä¹¦
3. å¼€å¯ **å¼ºåˆ¶HTTPS**

---

## âœ… éªŒè¯å®‰è£…

1. è®¿é—® `https://ä½ çš„åŸŸå`
2. ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·ç™»å½•ï¼š
   - **é‚®ç®±**ï¼š`admin@demo.com`
   - **å¯†ç **ï¼š`password`
3. **ç™»å½•åè¯·ç«‹å³ä¿®æ”¹å¯†ç ï¼**

---

## â° é…ç½®å®šæ—¶ä»»åŠ¡

åœ¨å®å¡” **è®¡åˆ’ä»»åŠ¡** ä¸­æ·»åŠ ï¼š

| ä»»åŠ¡åç§° | æ‰§è¡Œå‘¨æœŸ | è„šæœ¬å†…å®¹ |
|---------|---------|---------|
| Laravel è°ƒåº¦å™¨ | æ¯åˆ†é’Ÿ | `cd /www/wwwroot/ä½ çš„ç«™ç‚¹ç›®å½• && php artisan schedule:run >> /dev/null 2>&1` |

---

## ğŸ”§ å¸¸è§é—®é¢˜

### 1. é¡µé¢æ˜¾ç¤º 500 é”™è¯¯
```bash
# æ£€æŸ¥æ—¥å¿—
tail -100 storage/logs/laravel.log

# ç¡®ä¿æƒé™æ­£ç¡®
chown -R www:www /www/wwwroot/ä½ çš„ç«™ç‚¹ç›®å½•
chmod -R 775 storage bootstrap/cache
```

### 2. ç™»å½•å¯†ç é”™è¯¯
åœ¨ phpMyAdmin ä¸­æ‰§è¡Œï¼š
```sql
UPDATE users 
SET password = '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi' 
WHERE email = 'admin@demo.com';
```

### 3. å›¾ç‰‡ä¸Šä¼ å¤±è´¥
```bash
# æ£€æŸ¥ storage é“¾æ¥
ls -la public/storage

# é‡æ–°åˆ›å»ºé“¾æ¥
rm -f public/storage
php artisan storage:link
```

### 4. æ ·å¼/è„šæœ¬åŠ è½½å¤±è´¥
```bash
# é‡æ–°ç¼–è¯‘å‰ç«¯
npm run build

# æ¸…ç†ç¼“å­˜
php artisan optimize:clear
```

### 5. æ•°æ®åº“è¿ç§»æŠ¥é”™"åˆ—å·²å­˜åœ¨"
æ£€æŸ¥ `database/migrations/` ç›®å½•ä¸­æ˜¯å¦æœ‰é‡å¤çš„è¿ç§»æ–‡ä»¶ï¼ˆç›¸åŒåŠŸèƒ½ä½†ä¸åŒæ—¶é—´æˆ³ï¼‰ï¼Œåˆ é™¤é‡å¤çš„æ–‡ä»¶åé‡è¯•ã€‚

---

## ğŸ“¦ ç³»ç»Ÿå‡çº§

```bash
cd /www/wwwroot/ä½ çš„ç«™ç‚¹ç›®å½•

# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# æ›´æ–°ä¾èµ–
composer install --no-dev --optimize-autoloader
npm install
npm run build

# è¿è¡Œè¿ç§»
php artisan migrate --force

# æ¸…ç†ç¼“å­˜
php artisan optimize:clear
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ `storage/logs/laravel.log` ä¸­çš„é”™è¯¯æ—¥å¿—
2. æŸ¥çœ‹å®å¡”é¢æ¿çš„ Nginx/PHP é”™è¯¯æ—¥å¿—
3. æäº¤ Issue åˆ°é¡¹ç›®ä»“åº“
